#
# NOTE: this file was automatically generated. Do not edit!
#

require 'spec_helper'
require 'ronin/asm/syscalls/macos'

describe Ronin::ASM::Syscalls::MacOS do
  subject do
    obj = Object.new
    obj.extend Ronin::ASM::Syscalls::MacOS
    obj
  end
  <%- @syscalls.each do |syscall| -%>
  <%-   next if syscall.audit == :AUE_NULL -%>

  describe "#<%= syscall.name %>_syscall" do
    <%- if syscall.has_arguments? -%>
    let(:arguments) { [<%= syscall.arguments.map.with_index { |arg,index| "double('arg#{index + 1}')" }.join(', ') %>] }

    it "must call #syscall_macro with the syscall number <%= syscall.number.inspect %> and additional arguments" do
      expect(subject).to receive(:syscall_macro).with(<%= syscall.number.inspect %>,*arguments)

      subject.<%= syscall.name %>_syscall(*arguments)
    end
    <%- else -%>
    let(:arguments) { [] }

    it "must call #syscall_macro with the syscall number <%= syscall.number.inspect %>" do
      expect(subject).to receive(:syscall_macro).with(<%= syscall.number.inspect %>)

      subject.<%= syscall.name %>_syscall
    end
    <%- end -%>
  end
  <%- end -%>
end
